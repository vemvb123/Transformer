#!/bin/bash

#SBATCH -A master
#SBATCH -p normal

# output file
#SBATCH --output=output.out

# Use 4 nodes
##SBATCH --nodes=4

# use hpc2 (example)
#SBATCH --ntasks=1
#SBATCH --ntasks-per-node=1 
#SBATCH --nodelist=hpc2
#SBATCH --gpus-per-node=2
#SBATCH --cpus-per-task=4  # Adjust CPU allocation per task
#SBATCH -t 10-00:00:00
#SBATCH --gpu-bind=none

# Load environment
source ../env/bin/activate

# Set JAX distributed environment variables
# export NCCL_DEBUG=INFO
# export JAX_USE_PJRT_CUDA=0   # Force JAX to use multi-node setup
# export JAX_PLATFORMS="cuda"

# run python script
python train.py


